From 3c2ee2c62cd7979e13792f17be0529a2a5362cb7 Mon Sep 17 00:00:00 2001
From: Thorsten Otto <admin@tho-otto.de>
Date: Thu, 15 Mar 2018 05:49:39 +0100
Subject: [PATCH 39/63] sysvinitdeps

---
 scripts/Makefile.am     |  2 ++
 scripts/sysvinitdeps.sh | 17 +++++++++++++++++
 2 files changed, 19 insertions(+)
 create mode 100644 scripts/sysvinitdeps.sh

diff --git a/scripts/Makefile.am b/scripts/Makefile.am
index 1e3327d68..154f8af10 100644
--- a/scripts/Makefile.am
+++ b/scripts/Makefile.am
@@ -24,6 +24,7 @@ EXTRA_DIST = \
 	ocaml-find-requires.sh ocaml-find-provides.sh \
 	pkgconfigdeps.sh libtooldeps.sh metainfo.prov \
 	fontconfig.prov desktop-file.prov script.req \
+	sysvinitdeps.sh \
 	macros.perl macros.php macros.python
 
 rpmconfig_SCRIPTS = \
@@ -42,6 +43,7 @@ rpmconfig_SCRIPTS = \
 	pkgconfigdeps.sh libtooldeps.sh \
 	ocaml-find-requires.sh ocaml-find-provides.sh \
 	fontconfig.prov desktop-file.prov script.req \
+	sysvinitdeps.sh \
 	rpmdb_loadcvt rpm2cpio.sh tgpg 
 
 rpmconfig_DATA = \
diff --git a/scripts/sysvinitdeps.sh b/scripts/sysvinitdeps.sh
new file mode 100644
index 000000000..ea9138389
--- /dev/null
+++ b/scripts/sysvinitdeps.sh
@@ -0,0 +1,17 @@
+#!/bin/sh
+
+[ "$1" = '-P' -o "$1" = '--provides' ] || {
+    cat > /dev/null
+    exit 0
+}
+
+while read file; do
+	case $file in
+          */etc/init.d/*)
+		provs=`grep '^# *Provides:' $file | sed 's,^.*:,,'`
+		for p in $provs; do
+			echo "sysvinit($p)"
+		done
+	  ;;
+        esac
+done
-- 
2.16.2


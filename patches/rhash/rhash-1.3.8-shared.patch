Description: Install development files with shared library.
Author: Kyrill Detinov <lazy.kent@opensuse.org>
Index: RHash-1.3.8/librhash/Makefile
===================================================================
--- RHash-1.3.8/librhash/Makefile.orig	2019-05-06 14:45:41.337711896 +0200
+++ RHash-1.3.8/librhash/Makefile	2019-05-06 14:46:15.017711163 +0200
@@ -21,7 +21,7 @@
 config.mak:
 	echo "Run the ./configure script first" && false
 
-install-lib-static: $(LIBRHASH_STATIC)
+install-lib-static: $(LIBRHASH_STATIC) install-lib-headers
 	$(INSTALL) -d $(LIBDIR)
 	$(INSTALL_DATA) $(LIBRHASH_STATIC) $(LIBDIR)/
 
--- RHash-1.3.8/librhash/byte_order.h.orig	2019-05-06 14:53:28.193701737 +0200
+++ RHash-1.3.8/librhash/byte_order.h	2019-05-06 14:53:53.481701187 +0200
@@ -86,7 +86,7 @@
 
 #if defined(_MSC_VER)
 #define ALIGN_ATTR(n) __declspec(align(n))
-#elif defined(__GNUC__)
+#elif defined(__GNUC__) && !defined(__m68k__)
 #define ALIGN_ATTR(n) __attribute__((aligned (n)))
 #else
 #define ALIGN_ATTR(n) /* nothing */
--- RHash-1.3.8/configure.orig	2019-05-06 15:12:44.952765829 +0200
+++ RHash-1.3.8/configure	2019-05-06 15:13:11.600765249 +0200
@@ -796,7 +796,6 @@
   cat > ${RHASH_SRC}config.mak << EOF
 # -------- Generated by configure -----------
 
-DESTDIR $Q_ASSIGN
 BINDIR       = \$(DESTDIR)$INSTALL_BINDIR
 SYSCONFDIR   = \$(DESTDIR)$INSTALL_SYSCONFDIR
 MANDIR       = \$(DESTDIR)$INSTALL_MANDIR
@@ -837,7 +836,6 @@
   cat > ${LIBRHASH_SRC}config.mak << EOF
 # -------- Generated by configure -----------
 
-DESTDIR $Q_ASSIGN
 INCDIR  = \$(DESTDIR)$INSTALL_INCDIR
 LIBDIR  = \$(DESTDIR)$INSTALL_LIBDIR
 SO_DIR  = \$(DESTDIR)$INSTALL_SO_DIR
--- RHash-1.3.8/Makefile.orig	2019-05-06 15:29:03.824744528 +0200
+++ RHash-1.3.8/Makefile	2019-05-06 15:30:06.296743169 +0200
@@ -76,11 +76,11 @@
 install-binary: mkdir-bin
 	$(INSTALL_PROGRAM) $(RHASH_BINARY) $(BINDIR)/$(RHASH_BINARY)
 
-install-man:
+install-man::
 	$(INSTALL) -d $(MANDIR)/man1
 	$(INSTALL_DATA) dist/rhash.1 $(MANDIR)/man1/rhash.1
 
-install-conf:
+install-conf::
 	$(INSTALL) -d $(SYSCONFDIR)
 	tr -d \\r < dist/rhashrc.sample > rc.tmp && $(INSTALL_DATA) rc.tmp $(SYSCONFDIR)/rhashrc
 	rm -f rc.tmp
@@ -90,7 +90,7 @@
 	cd $(BINDIR) && for f in $(SYMLINKS); do $(LN_S) $(RHASH_BINARY) $$f$(EXEC_EXT); done
 	cd $(MANDIR)/man1 && for f in $(SYMLINKS); do $(LN_S) rhash.1 $$f.1; done
 
-install-pkg-config:
+install-pkg-config::
 	$(INSTALL) -d $(PKGCONFIGDIR)
 	$(INSTALL_DATA) $(LIBRHASH_PC) $(PKGCONFIGDIR)/
 
--- a/librhash/rhash.c	2019-05-07 13:53:49.187052506 +0200
+++ b/librhash/rhash.c	2019-05-07 13:54:00.579052258 +0200
@@ -133,7 +133,9 @@
 		if ((hash_id & id) != 0) {
 			info = &rhash_info_table[bit_index];
 			assert(info->context_size > 0);
+#if 0
 			assert(((phash_ctx - (char*)0) & 7) == 0); /* hash context is aligned */
+#endif
 			assert(info->init != NULL);
 
 			rctx->vector[i].hash_info = info;

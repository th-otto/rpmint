diff -rup glib-1.2.10.orig/Makefile.am glib-1.2.10/Makefile.am
--- glib-1.2.10.orig/Makefile.am	2000-10-28 06:35:30.000000000 +0200
+++ glib-1.2.10/Makefile.am	2023-03-27 14:23:09.556743038 +0200
@@ -11,7 +11,7 @@ bin_SCRIPTS=glib-config
 BUILT_SOURCES=glib-config
 glib-config: glib-config.in
 
-INCLUDES = -DG_LOG_DOMAIN=g_log_domain_glib @GLIB_DEBUG_FLAGS@
+AM_CPPFLAGS = -DG_LOG_DOMAIN=g_log_domain_glib @GLIB_DEBUG_FLAGS@
 
 EXTRA_DIST = \
 	glib.m4			\
@@ -70,7 +70,7 @@ configinclude_DATA = \
 
 CONFIGURE_DEPENDENCIES = acglib.m4		
 
-BUILT_SOURCES = stamp-gc-h #note: not glibconfig.h
+BUILT_SOURCES += stamp-gc-h #note: not glibconfig.h
 glibconfig.h: stamp-gc-h
 	@:
 stamp-gc-h: config.status
diff -rup glib-1.2.10.orig/acglib.m4 glib-1.2.10/acglib.m4
--- glib-1.2.10.orig/acglib.m4	1999-01-05 00:37:40.000000000 +0100
+++ glib-1.2.10/acglib.m4	2023-03-27 14:23:09.556743038 +0200
@@ -29,13 +29,13 @@ dnl GLIB_SIZEOF (INCLUDES, TYPE, ALIAS [
 AC_DEFUN(GLIB_SIZEOF,
 [changequote(<<, >>)dnl
 dnl The name to #define.
-define(<<AC_TYPE_NAME>>, translit(glib_sizeof_$3, [a-z *], [A-Z_P]))dnl
+m4_define(<<AC_TYPE_NAME>>, translit(glib_sizeof_$3, [a-z *], [A-Z_P]))dnl
 dnl The cache variable name.
-define(<<AC_CV_NAME>>, translit(glib_cv_sizeof_$3, [ *], [_p]))dnl
+m4_define(<<AC_CV_NAME>>, translit(glib_cv_sizeof_$3, [ *], [_p]))dnl
 changequote([, ])dnl
 AC_MSG_CHECKING(size of $2)
 AC_CACHE_VAL(AC_CV_NAME,
-[AC_TRY_RUN([#include <stdio.h>
+AC_RUN_IFELSE([AC_LANG_SOURCE([[#include <stdio.h>
 $1
 main()
 {
@@ -43,24 +43,24 @@ main()
   if (!f) exit(1);
   fprintf(f, "%d\n", sizeof($2));
   exit(0);
-}], AC_CV_NAME=`cat conftestval`, AC_CV_NAME=0, ifelse([$4], , , AC_CV_NAME=$4))])dnl
+}]])], AC_CV_NAME=`cat conftestval`, AC_CV_NAME=1, ifelse([$4], , , AC_CV_NAME=$4)))dnl
 AC_MSG_RESULT($AC_CV_NAME)
 AC_DEFINE_UNQUOTED(AC_TYPE_NAME, $AC_CV_NAME)
-undefine([AC_TYPE_NAME])dnl
-undefine([AC_CV_NAME])dnl
+m4_undefine([AC_TYPE_NAME])dnl
+m4_undefine([AC_CV_NAME])dnl
 ])
 
 dnl GLIB_BYTE_CONTENTS (INCLUDES, TYPE, ALIAS, N_BYTES, INITIALIZER)
 AC_DEFUN(GLIB_BYTE_CONTENTS,
 [changequote(<<, >>)dnl
 dnl The name to #define.
-define(<<AC_TYPE_NAME>>, translit(glib_byte_contents_$3, [a-z *], [A-Z_P]))dnl
+m4_define(<<AC_TYPE_NAME>>, translit(glib_byte_contents_$3, [a-z *], [A-Z_P]))dnl
 dnl The cache variable name.
-define(<<AC_CV_NAME>>, translit(glib_cv_byte_contents_$3, [ *], [_p]))dnl
+m4_define(<<AC_CV_NAME>>, translit(glib_cv_byte_contents_$3, [ *], [_p]))dnl
 changequote([, ])dnl
 AC_MSG_CHECKING(byte contents of $2)
 AC_CACHE_VAL(AC_CV_NAME,
-[AC_TRY_RUN([#include <stdio.h>
+[AC_RUN_IFELSE([AC_LANG_SOURCE([[#include <stdio.h>
 $1
 main()
 {
@@ -73,11 +73,11 @@ main()
     fprintf(f, "%s%d", i?",":"", *(p++));
   fprintf(f, "\n");
   exit(0);
-}], AC_CV_NAME=`cat conftestval`, AC_CV_NAME=0, AC_CV_NAME=0)])dnl
+}]])], AC_CV_NAME=`cat conftestval`, AC_CV_NAME=0, AC_CV_NAME=0)])dnl
 AC_MSG_RESULT($AC_CV_NAME)
 AC_DEFINE_UNQUOTED(AC_TYPE_NAME, $AC_CV_NAME)
-undefine([AC_TYPE_NAME])dnl
-undefine([AC_CV_NAME])dnl
+m4_undefine([AC_TYPE_NAME])dnl
+m4_undefine([AC_CV_NAME])dnl
 ])
 
 dnl GLIB_SYSDEFS (INCLUDES, DEFS_LIST, OFILE [, PREFIX])
@@ -111,8 +111,14 @@ for glib_sysdef_input in $2 ; do
 	echo "#endif" >>confrun.c
 done
 echo "return 0; }" >>confrun.c
-AC_TRY_RUN(`cat confrun.c`, AC_MSG_RESULT(done),
-[	for glib_sysdef_input in $2 ; do
+glib_ok=no
+AC_RUN_IFELSE([AC_LANG_SOURCE([[`cat confrun.c`]])], [AC_MSG_RESULT(done)
+glib_ok=yes],
+[AC_MSG_RESULT(failed)],
+[AC_MSG_RESULT(guessing)])
+rm -f confrun.c
+if test "$glib_ok" != yes; then
+	for glib_sysdef_input in $2 ; do
 		glib_sysdef=`echo $glib_sysdef_input | sed 's/^\([[^:]]*\):.*$/\1/'`
 		glib_default=`echo $glib_sysdef_input | sed 's/^[[^:]]*:\(.*\)$/\1/'`
 		if test $glib_sysdef != $glib_default; then
@@ -122,6 +128,5 @@ AC_TRY_RUN(`cat confrun.c`, AC_MSG_RESUL
 		fi
 		echo "#define GLIB_SYSDEF_$glib_sysdef$glib_default" >>$glib_sysdefso
 	done
-	AC_MSG_RESULT(failed)])
-rm -f confrun.c
+fi
 ])
diff -rup glib-1.2.10.orig/configure.in glib-1.2.10/configure.in
--- glib-1.2.10.orig/configure.in	2001-03-15 16:37:37.000000000 +0100
+++ glib-1.2.10/configure.in	2023-03-27 14:27:12.436462260 +0200
@@ -3,11 +3,21 @@
 dnl ***********************************
 builtin(include, acglib.m4)dnl
 
-# require autoconf 2.13
-AC_PREREQ(2.13)
+# require autoconf 2.59
+AC_PREREQ([2.59])
+
+m4_define([glib_major_version], [1])
+m4_define([glib_minor_version], [2])
+m4_define([glib_micro_version], [10])
+m4_define([glib_interface_age], [10])
+m4_define([glib_binary_age], [10])
+m4_define([glib_version],
+          [glib_major_version.glib_minor_version.glib_micro_version])
 
 # init autoconf (and check for presence of glist.c)
-AC_INIT(glist.c)
+AC_INIT([glib],[glib_version],[http://bugzilla.gnome.org/enter_bug.cgi?product=glib],[],[])
+AC_CONFIG_SRCDIR([glist.c])
+AC_CONFIG_AUX_DIR([.])
 
 # Save this value here, since automake will set cflags later
 cflags_set=${CFLAGS+set}
@@ -15,9 +25,6 @@
 # we rewrite this file
 rm -f glibconfig-sysdefs.h
 
-dnl we need to AC_DIVERT_PUSH/AC_DIVERT_POP these variable definitions so they
-dnl are available for $ac_help expansion (don't we all *love* autoconf?)
-AC_DIVERT_PUSH(AC_DIVERSION_NOTICE)dnl
 #
 # The following version number definitions apply to GLib, GModule and GThread
 # as a whole, so if changes occoured in any of them, they are all
@@ -31,14 +38,13 @@
 # if backwards compatibility has been broken,
 # set GLIB_BINARY_AGE _and_ GLIB_INTERFACE_AGE to 0.
 #
-GLIB_MAJOR_VERSION=1
-GLIB_MINOR_VERSION=2
-GLIB_MICRO_VERSION=10
-GLIB_INTERFACE_AGE=10
-GLIB_BINARY_AGE=10
-GLIB_VERSION=$GLIB_MAJOR_VERSION.$GLIB_MINOR_VERSION.$GLIB_MICRO_VERSION
+GLIB_MAJOR_VERSION=glib_major_version
+GLIB_MINOR_VERSION=glib_minor_version
+GLIB_MICRO_VERSION=glib_micro_version
+GLIB_INTERFACE_AGE=glib_interface_age
+GLIB_BINARY_AGE=glib_binary_age
+GLIB_VERSION=glib_version
 dnl
-AC_DIVERT_POP()dnl
 
 AC_SUBST(GLIB_MAJOR_VERSION)
 AC_SUBST(GLIB_MINOR_VERSION)
@@ -60,19 +66,24 @@
 VERSION=$GLIB_VERSION
 PACKAGE=glib
 
-AM_INIT_AUTOMAKE($PACKAGE, $VERSION, no-define)
+AM_INIT_AUTOMAKE(no-define)
 
 # Specify a configuration file
-AM_CONFIG_HEADER(config.h)
+AC_CONFIG_HEADERS([config.h])
 
-AC_DEFINE_UNQUOTED(GLIB_MAJOR_VERSION, $GLIB_MAJOR_VERSION)
-AC_DEFINE_UNQUOTED(GLIB_MINOR_VERSION, $GLIB_MINOR_VERSION)
-AC_DEFINE_UNQUOTED(GLIB_MICRO_VERSION, $GLIB_MICRO_VERSION)
-AC_DEFINE_UNQUOTED(GLIB_INTERFACE_AGE, $GLIB_INTERFACE_AGE)
-AC_DEFINE_UNQUOTED(GLIB_BINARY_AGE, $GLIB_BINARY_AGE)
+AC_DEFINE(GLIB_MAJOR_VERSION, [glib_major_version],
+	  [Define to the GLIB major version])
+AC_DEFINE(GLIB_MINOR_VERSION, [glib_minor_version],
+	  [Define to the GLIB minor version])
+AC_DEFINE(GLIB_MICRO_VERSION, [glib_micro_version],
+	  [Define to the GLIB micro version])
+AC_DEFINE(GLIB_INTERFACE_AGE, [glib_interface_age],
+	  [Define to the GLIB interface age])
+AC_DEFINE(GLIB_BINARY_AGE, [glib_binary_age],
+	  [Define to the GLIB binary age])
 
 dnl Initialize libtool
-AM_PROG_LIBTOOL
+LT_INIT
 
 dnl Initialize maintainer mode
 AM_MAINTAINER_MODE
@@ -81,13 +92,11 @@
 
 dnl figure debugging default, prior to $ac_help setup
 dnl
-AC_DIVERT_PUSH(AC_DIVERSION_NOTICE)dnl
 if test `expr $GLIB_MINOR_VERSION \% 2` = 1 ; then
 	debug_default=yes
 else
 	debug_default=minimum
 fi
-AC_DIVERT_POP()dnl
 
 dnl declare --enable-* args and collect ac_help strings
 AC_ARG_ENABLE(debug, [  --enable-debug=[no/minimum/yes] turn on debugging [default=$debug_default]],,enable_debug=$debug_default)
@@ -104,7 +113,7 @@
 
 mem_warn=false
 
-AC_MSG_CHECKING(whether to enable memory checking)
+AC_MSG_CHECKING([whether to enable memory checking])
 if test "x$enable_mem_check" = "xyes"; then
   AC_DEFINE(ENABLE_MEM_CHECK, 1)
   AC_SUBST(ENABLE_MEM_CHECK)
@@ -114,7 +123,7 @@
   AC_MSG_RESULT(no)
 fi
 
-AC_MSG_CHECKING(whether to enable memory profiling)
+AC_MSG_CHECKING([whether to enable memory profiling])
 if test "x$enable_mem_profile" = "xyes"; then
   AC_DEFINE(ENABLE_MEM_PROFILE, 1)
   AC_SUBST(ENABLE_MEM_PROFILE)
@@ -154,7 +163,6 @@
 
 # Checks for programs.
 AC_PROG_CC
-AM_PROG_CC_STDC
 AC_PROG_INSTALL
 
 changequote(,)dnl
@@ -182,36 +190,38 @@
 AC_MSG_CHECKING([for extra flags to get ANSI library prototypes])
 glib_save_LIBS=$LIBS
 LIBS="$LIBS -lm"
-AC_TRY_RUN([#include <math.h>
-             int main (void) { return (log(1) != log(1.)); }],
-     AC_MSG_RESULT(none needed),
-     glib_save_CFLAGS=$CFLAGS
+AC_RUN_IFELSE([AC_LANG_SOURCE([[#include <math.h>
+             int main (void) { return (log(1) != log(1.)); }]])],
+     AC_MSG_RESULT([none needed]),
+     [glib_save_CFLAGS=$CFLAGS
      CFLAGS="$CFLAGS -std1"
-     AC_TRY_RUN([#include <math.h>
-                 int main (void) { return (log(1) != log(1.)); }],
-         AC_MSG_RESULT(-std1),
-         AC_MSG_RESULT()
+     AC_RUN_IFELSE([AC_LANG_SOURCE([[#include <math.h>
+                 int main (void) { return (log(1) != log(1.)); }]])],
+         [AC_MSG_RESULT(-std1)],
+         [AC_MSG_RESULT()
          CFLAGS=$glib_save_CFLAGS
-         AC_MSG_WARN(
-                [No ANSI prototypes found in library. (-std1 didn't work.)])
-     )
+         AC_MSG_WARN([No ANSI prototypes found in library. (-std1 didn't work.)])],
+         [AC_MSG_RESULT([guessing none needed])]
+     )],
+     [AC_MSG_RESULT([guessing none needed])]
 )
 LIBS=$glib_save_LIBS
 
 dnl NeXTStep cc seems to need this
 AC_MSG_CHECKING([for extra flags for POSIX compliance])
-AC_TRY_COMPILE([#include <dirent.h>], [DIR *dir;],
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <dirent.h>]], [[DIR *dir;]])],
   AC_MSG_RESULT(none needed),
   glib_save_CFLAGS=$CFLAGS
   CFLAGS="$CFLAGS -posix"
-  AC_TRY_COMPILE([#include <dirent.h>], [DIR *dir;],
+  AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <dirent.h>]], [[DIR *dir;]])],
     AC_MSG_RESULT(-posix),
     AC_MSG_RESULT()
     CFLAGS=$glib_save_CFLAGS
     AC_MSG_WARN([Could not determine POSIX flag. (-posix didn't work.)])))
 
 # Checks for header files.
-AC_HEADER_STDC
+AC_CHECK_INCLUDES_DEFAULT
+AC_PROG_EGREP
 
 # Checks for library functions.
 AC_FUNC_VPRINTF
@@ -226,52 +236,49 @@
 AC_CHECK_SIZEOF(long long)
 
 dnl long doubles were not used, and a portability problem
-dnl AC_C_LONG_DOUBLE
+    AC_TYPE_LONG_DOUBLE_WIDER
+    ac_cv_c_long_double=$ac_cv_type_long_double_wider
+    if test $ac_cv_c_long_double = yes; then
+      AC_DEFINE([HAVE_LONG_DOUBLE],[1],[Define to 1 if the type `long double' works and has more range or
+	 precision than `double'.])
+    fi
+  
 AC_C_CONST
 
 dnl AC_C_INLINE is useless to us since it bails out too early, we need to
 dnl truely know which ones of `inline', `__inline' and `__inline__' are
 dnl actually supported.
-AC_MSG_CHECKING(for __inline)
+AC_MSG_CHECKING([for __inline])
 AC_CACHE_VAL(glib_cv_has__inline,[
-        AC_TRY_RUN([
-	__inline int foo () { return 0; }
-	int main () { return foo (); }
-       	],
-	glib_cv_has__inline=yes
-        ,
-	glib_cv_has__inline=no
-        ,)
+        AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[
+	__inline int foo () { return 0; }]],
+       	[[]])],
+	glib_cv_has__inline=yes,
+	glib_cv_has__inline=no)
 ])
 AC_MSG_RESULT($glib_cv_has__inline)
 case x$glib_cv_has__inline in
 xyes) AC_DEFINE(G_HAVE___INLINE)
 esac
-AC_MSG_CHECKING(for __inline__)
+AC_MSG_CHECKING([for __inline__])
 AC_CACHE_VAL(glib_cv_has__inline__,[
-        AC_TRY_RUN([
-	__inline__ int foo () { return 0; }
-	int main () { return foo (); }
-       	],
-	glib_cv_has__inline__=yes
-        ,
-	glib_cv_has__inline__=no
-        ,)
+        AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[
+	__inline__ int foo () { return 0; }]]
+       	[[]])],
+	glib_cv_has__inline__=yes,
+	glib_cv_has__inline__=no)
 ])
 AC_MSG_RESULT($glib_cv_has__inline__)
 case x$glib_cv_has__inline__ in
 xyes) AC_DEFINE(G_HAVE___INLINE__)
 esac
-AC_MSG_CHECKING(for inline)
+AC_MSG_CHECKING([for inline])
 AC_CACHE_VAL(glib_cv_hasinline,[
-        AC_TRY_RUN([
-	inline int foo () { return 0; }
-	int main () { return foo (); }
-       	],
-	glib_cv_hasinline=yes
-        ,
-	glib_cv_hasinline=no
-        ,)
+        AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[
+	inline int foo () { return 0; }]],
+       	[[]])],
+	glib_cv_hasinline=yes,
+	glib_cv_hasinline=no)
 ])
 AC_MSG_RESULT($glib_cv_hasinline)
 case x$glib_cv_hasinline in
@@ -297,33 +304,33 @@
 AC_CHECK_FUNCS(lstat strerror strsignal memmove vsnprintf strcasecmp strncasecmp poll)
 
 # Check for sys_errlist
-AC_MSG_CHECKING(for sys_errlist)
-AC_TRY_LINK(, [
+AC_MSG_CHECKING([for sys_errlist])
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[]], [[
 extern char *sys_errlist[];
 extern int sys_nerr;
 sys_errlist[sys_nerr-1][0] = 0;
-], glib_ok=yes, glib_ok=no)
+]])], glib_ok=yes, glib_ok=no)
 AC_MSG_RESULT($glib_ok)
 if test $glib_ok = no; then
     AC_DEFINE(NO_SYS_ERRLIST)
 fi
 
 # Check for sys_siglist
-AC_MSG_CHECKING(for sys_siglist)
-AC_TRY_LINK(, [
+AC_MSG_CHECKING([for sys_siglist])
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[]], [[
 extern char *sys_siglist[];
 exit (sys_siglist[0]);
-], glib_ok=yes, glib_ok=no)
+]])], glib_ok=yes, glib_ok=no)
 AC_MSG_RESULT($glib_ok)
 if test $glib_ok = no; then
     AC_DEFINE(NO_SYS_SIGLIST)
 fi
 
 # Check for sys_siglist decl (see Tue Jan 19 00:44:24 1999 in changelog)
-AC_MSG_CHECKING(for sys_siglist declaration)
-AC_TRY_COMPILE([#include <signal.h>], [
+AC_MSG_CHECKING([for sys_siglist declaration])
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <signal.h>]], [[
 strlen (sys_siglist[0]);
-], glib_ok=yes, glib_ok=no)
+]])], glib_ok=yes, glib_ok=no)
 AC_MSG_RESULT($glib_ok)
 if test $glib_ok = no; then
     AC_DEFINE(NO_SYS_SIGLIST_DECL)
@@ -331,12 +338,12 @@
 
 # Check if <sys/select.h> needs to be included for fd_set
 AC_MSG_CHECKING([for fd_set])
-AC_TRY_COMPILE([#include <sys/types.h>],
-        [fd_set readMask, writeMask;], gtk_ok=yes, gtk_ok=no)
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <sys/types.h>]],
+        [[fd_set readMask, writeMask;]])], gtk_ok=yes, gtk_ok=no)
 if test $gtk_ok = yes; then
     AC_MSG_RESULT([yes, found in sys/types.h])
 else
-    AC_HEADER_EGREP(fd_mask, sys/select.h, gtk_ok=yes)
+    AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <sys/select.h]],[[]])], gtk_ok=yes, gtk_ok=no)
     if test $gtk_ok = yes; then
         AC_DEFINE(HAVE_SYS_SELECT_H)
         AC_MSG_RESULT([yes, found in sys/select.h])
@@ -353,8 +360,8 @@
 
 # Check for wchar.h
 
-AC_MSG_CHECKING(for wchar.h)
-AC_TRY_CPP([#include <wchar.h>], glib_wchar_h=yes, glib_wchar_h=no)
+AC_MSG_CHECKING([for wchar.h])
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <wchar.h>]], [[]])], glib_wchar_h=yes, glib_wchar_h=no)
 if test $glib_wchar_h = yes; then
    AC_DEFINE(HAVE_WCHAR_H)
 fi
@@ -362,8 +369,8 @@
 
 # Check for wctype.h (for iswalnum)
 
-AC_MSG_CHECKING(for wctype.h)
-AC_TRY_CPP([#include <wctype.h>], glib_wctype_h=yes, glib_wctype_h=no)
+AC_MSG_CHECKING([for wctype.h])
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <wctype.h>]],[[]])], glib_wctype_h=yes, glib_wctype_h=no)
 if test $glib_wctype_h = yes; then
    AC_DEFINE(HAVE_WCTYPE_H)
 fi
@@ -374,8 +381,8 @@
 AC_CHECK_FUNC(iswalnum,,[AC_CHECK_LIB(w,iswalnum)])
 
 # The following is necessary for Linux libc-5.4.38
-AC_MSG_CHECKING(if iswalnum() and friends are properly defined)
-AC_TRY_LINK([#include <stdlib.h>],[
+AC_MSG_CHECKING([if iswalnum() and friends are properly defined])
+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <stdlib.h>]],[[
 #if (defined(HAVE_WCTYPE_H) || defined(HAVE_WCHAR_H))
 #  ifdef HAVE_WCTYPE_H
 #    include <wctype.h>
@@ -388,7 +395,7 @@
 #  define iswalnum(c) ((wchar_t)(c) <= 0xFF && isalnum(c))
 #endif
 iswalnum((wchar_t) 0);
-], glib_working_wctype=yes, glib_working_wctype=no)
+]])], glib_working_wctype=yes, glib_working_wctype=no)
 LIBS="$oLIBS"
 
 if test $glib_working_wctype = no; then
@@ -397,30 +404,30 @@
 AC_MSG_RESULT($glib_working_wctype)
 
 dnl *** check for sane realloc() ***
-AC_MSG_CHECKING(whether realloc (NULL,) will work)
+AC_MSG_CHECKING([whether realloc (NULL,) will work])
 AC_CACHE_VAL(glib_cv_sane_realloc,[
-	AC_TRY_RUN([
+	AC_RUN_IFELSE([AC_LANG_SOURCE([[
 	#include <stdlib.h>
 	int main() {
 	  return realloc (0, sizeof (int)) == 0;
-	}],
-	glib_cv_sane_realloc=yes
-	AC_DEFINE(REALLOC_0_WORKS)
-	,
-	glib_cv_sane_realloc=no
-	,)
+	}]])],
+	glib_cv_sane_realloc=yes,
+	glib_cv_sane_realloc=no,
+	glib_cv_sane_realloc=yes)
 ])
 AC_MSG_RESULT($glib_cv_sane_realloc)
-
+if test "$glib_cv_sane_realloc" = yes; then
+	AC_DEFINE(REALLOC_0_WORKS, [whether realloc (NULL,) will work])
+fi
 
 dnl **********************
 dnl *** va_copy checks ***
 dnl **********************
 dnl we currently check for all three va_copy possibilities, so we get
 dnl all results in config.log for bug reports.
-AC_MSG_CHECKING(for an implementation of va_copy())
+AC_MSG_CHECKING([for an implementation of va_copy()])
 AC_CACHE_VAL(glib_cv_va_copy,[
-	AC_TRY_RUN([
+	AC_LINK_IFELSE([AC_LANG_SOURCE([[
 	#include <stdarg.h>
 	void f (int i, ...) {
 	va_list args1, args2;
@@ -433,16 +440,14 @@
 	int main() {
 	  f (0, 42);
 	  return 0;
-	}],
-	glib_cv_va_copy=yes
-	,
-	glib_cv_va_copy=no
-	,)
+	}]])],
+	[glib_cv_va_copy=yes],
+	[glib_cv_va_copy=no])
 ])
 AC_MSG_RESULT($glib_cv_va_copy)
-AC_MSG_CHECKING(for an implementation of __va_copy())
+AC_MSG_CHECKING([for an implementation of __va_copy()])
 AC_CACHE_VAL(glib_cv___va_copy,[
-	AC_TRY_RUN([
+	AC_LINK_IFELSE([AC_LANG_SOURCE([[
 	#include <stdarg.h>
 	void f (int i, ...) {
 	va_list args1, args2;
@@ -455,16 +460,14 @@
 	int main() {
 	  f (0, 42);
 	  return 0;
-	}],
-	glib_cv___va_copy=yes
-	,
-	glib_cv___va_copy=no
-	,)
+	}]])],
+	glib_cv___va_copy=yes,
+	glib_cv___va_copy=no)
 ])
 AC_MSG_RESULT($glib_cv___va_copy)
-AC_MSG_CHECKING(whether va_lists can be copied by value)
+AC_MSG_CHECKING([whether va_lists can be copied by value])
 AC_CACHE_VAL(glib_cv_va_val_copy,[
-	AC_TRY_RUN([
+	AC_LINK_IFELSE([AC_LANG_SOURCE([[
 	#include <stdarg.h>
 	void f (int i, ...) {
 	va_list args1, args2;
@@ -477,11 +480,9 @@
 	int main() {
 	  f (0, 42);
 	  return 0;
-	}],
-	glib_cv_va_val_copy=yes
-	,
-	glib_cv_va_val_copy=no
-	,)
+	}]])],
+	glib_cv_va_val_copy=yes,
+	glib_cv_va_val_copy=no)
 ])
 if test "x$glib_cv_va_copy" = "xyes"; then
   AC_DEFINE(G_VA_COPY, va_copy)
@@ -523,13 +524,13 @@
 fi
 dnl *** shl_load() in libdld (HP-UX)
 if test -z "$G_MODULE_IMPL"; then
-        AC_MSG_CHECKING(how to export all symbols)
+        AC_MSG_CHECKING([how to export all symbols])
         SAVED_LDFLAGS=$LDFLAGS
         LDFLAGS="$LDFLAGS -Wl,-E"
-        AC_TRY_LINK(,[ return 0; ],
+        AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[]],[[ return 0; ]])],
                 [ G_MODULE_LDFLAGS="-Wl,-E" ],[
                 LDFLAGS="$SAVED_LDFLAGS -bexpall"
-                AC_TRY_LINK(,[ return 0; ],
+                AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[]],[[ return 0; ]])],
                         G_MODULE_LDFLAGS="-bexpall",
                         G_MODULE_LDFLAGS="none"
                 )
@@ -558,7 +559,7 @@
 dnl *** check for OSF1/5.0 RTLD_GLOBAL brokenness
         AC_CACHE_CHECK([for RTLD_GLOBAL brokenness],
                 glib_cv_rtldglobal_broken,[
-                AC_TRY_RUN([
+                AC_RUN_IFELSE([AC_LANG_SOURCE([[
                 #include <dlfcn.h>
                 #ifndef RTLD_GLOBAL
                 #define RTLD_GLOBAL 0
@@ -574,10 +575,10 @@
                 if (!handle) return 0;
                 local = dlsym (handle, "pthread_create");
                 return global == local;
-                }],
+                }]])],
                         [glib_cv_rtldglobal_broken=no],
                         [glib_cv_rtldglobal_broken=yes],
-                        [])
+                        [glib_cv_rtldglobal_broken=no])
                 rm -f plugin.c plugin.o plugin.lo
         ])
         if test "x$glib_cv_rtldglobal_broken" = "xyes"; then
@@ -586,9 +587,9 @@
                 G_MODULE_BROKEN_RTLD_GLOBAL=0
         fi
 dnl *** check whether we need preceeding underscores
-	AC_MSG_CHECKING(for preceeding underscore in symbols)
+	AC_MSG_CHECKING([for preceeding underscore in symbols])
 	AC_CACHE_VAL(glib_cv_uscore,[
-		AC_TRY_RUN([
+		AC_RUN_IFELSE([AC_LANG_SOURCE([[
 		#include <dlfcn.h>
                 int glib_underscore_test (void) { return 42; }
 		int main() {
@@ -598,9 +599,10 @@
 		    f1 = dlsym (handle, "glib_underscore_test");
 		    f2 = dlsym (handle, "_glib_underscore_test");
 		  } return (!f2 || f1);
-		}],
+		}]])],
 			glib_cv_uscore=yes,
 			glib_cv_uscore=no,
+			glib_cv_uscore=yes
 		)
 		rm -f plugin.c plugin.o plugin.lo
 	])
@@ -697,7 +699,7 @@
 	fi
 fi
 
-AC_MSG_CHECKING(for thread implementation)
+AC_MSG_CHECKING([for thread implementation])
 
 if test "x$have_threads" = xnone && test "x$want_threads" != xno; then
 	AC_MSG_RESULT(none available)
@@ -778,7 +780,7 @@
         AC_MSG_ERROR($LIBS_NOT_FOUND_1$have_threads$LIBS_NOT_FOUND_2)
 fi
 
-AC_MSG_CHECKING(necessary linker options)
+AC_MSG_CHECKING([necessary linker options])
 AC_MSG_RESULT($G_THREAD_LIBS)
 
 dnl determination of G_THREAD_CFLAGS
@@ -812,7 +814,7 @@
     AC_MSG_WARN($FLAG_DOES_NOT_WORK))
     CPPFLAGS=$old_CPPFLAGS
 
-    AC_MSG_CHECKING(necessary compiler options)
+    AC_MSG_CHECKING([necessary compiler options])
 
     AC_MSG_RESULT($G_THREAD_CFLAGS)
 else
@@ -833,7 +835,7 @@
 	if test "$ac_cv_header_pwd_h" = "yes"; then
 		AC_MSG_CHECKING([for getpwuid_r])
 	 	AC_CACHE_VAL(ac_cv_func_getpwuid_r,
-			[AC_TRY_RUN([#include <errno.h>
+			[AC_RUN_IFELSE([AC_LANG_SOURCE([[#include <errno.h>
 				int main () { char buffer[10000], *pointer; 
 				char getpwuid_r (long, void*, void*,
 					int, void*);
@@ -841,9 +843,10 @@
 				errno = 0;
 				error = getpwuid_r (0, &buffer, &buffer, 
 					sizeof (buffer), &pointer);
-				return errno == ENOSYS || error == ENOSYS;}],
+				return errno == ENOSYS || error == ENOSYS;}]])],
 				[ac_cv_func_getpwuid_r=yes],
-				[ac_cv_func_getpwuid_r=no])])
+				[ac_cv_func_getpwuid_r=no],
+				[ac_cv_func_getpwuid_r=yes])])
 		if test "$ac_cv_func_getpwuid_r" = yes; then
 			AC_MSG_RESULT(yes)
 			AC_DEFINE(HAVE_GETPWUID_R)
@@ -851,13 +854,13 @@
 			AC_MSG_RESULT(no)
 		fi
 		if test "$ac_cv_func_getpwuid_r" = "yes"; then
-			AC_MSG_CHECKING(whether getpwuid_r is posix like)
+			AC_MSG_CHECKING([whether getpwuid_r is posix like])
 			# The signature for the POSIX version is:
 			# int getpwuid_r(uid_t, struct passwd *, char *, size_t, struct passwd **)
-			AC_TRY_COMPILE([#include <pwd.h>
+			AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <pwd.h>
                                         #include <sys/types.h>
-                                        #include <stdlib.h>],
-				[getpwuid_r((uid_t)0, NULL, NULL, (size_t)0, NULL);],
+                                        #include <stdlib.h>]],
+				[[getpwuid_r((uid_t)0, NULL, NULL, (size_t)0, NULL);]])],
 				[AC_DEFINE(HAVE_GETPWUID_R_POSIX)
 				AC_MSG_RESULT(yes)],
 				[AC_MSG_RESULT(no)])
@@ -865,25 +868,30 @@
 	fi
 	if test x"$have_threads" = xposix; then
 		LIBS="$LIBS $G_THREAD_LIBS"
-		AC_MSG_CHECKING(whether pthread_getspecific is posix like)
+		AC_MSG_CHECKING([whether pthread_getspecific is posix like])
 		# PCThreads has pthread_getspecific(pthread_key_t, void **);
-		AC_TRY_COMPILE([#include <pthread.h>],
-			[pthread_getspecific(0,NULL);],
+		AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <pthread.h>]],
+			[[pthread_getspecific(0,NULL);]])],
 			[AC_MSG_RESULT(no)],
 			[AC_MSG_RESULT(yes)
 			AC_DEFINE(HAVE_PTHREAD_GETSPECIFIC_POSIX)])
-		AC_MSG_CHECKING(whether pthread_mutex_trylock is posix like)
+		AC_MSG_CHECKING([whether pthread_mutex_trylock is posix like])
 		# DCE Threads return 1 as success, posix 0. what a mess.
-		AC_TRY_RUN([#include <pthread.h>
+		glib_ok=no
+		AC_RUN_IFELSE([AC_LANG_SOURCE([[#include <pthread.h>
 			pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;
 			int main () { 
-			return !pthread_mutex_trylock (&mutex); }],
-			[AC_MSG_RESULT(no)],
-			[AC_MSG_RESULT(yes)
-			AC_DEFINE(HAVE_PTHREAD_MUTEX_TRYLOCK_POSIX)])
-		AC_MSG_CHECKING(whether pthread_cond_timedwait is posix like)
+			return !pthread_mutex_trylock (&mutex); }]])],
+			[glib_ok=no],
+			[glib_ok=yes],
+			[glib_ok="guessing yes"])
+		AC_MSG_RESULT($glib_ok)
+		if test "$glib_ok" != no; then
+			AC_DEFINE(HAVE_PTHREAD_MUTEX_TRYLOCK_POSIX)
+		fi
+		AC_MSG_CHECKING([whether pthread_cond_timedwait is posix like])
 		# DCE Threads return -1 as failure, posix ETIMEDOUT.
-		AC_TRY_RUN([#include <pthread.h>
+		AC_RUN_IFELSE([AC_LANG_SOURCE([[#include <pthread.h>
 			int main () { 
 			pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;
 			pthread_cond_t cond = PTHREAD_COND_INITIALIZER;
@@ -893,10 +901,14 @@
 			tspec.tv_sec = tval.tv_sec;
 			tspec.tv_nsec = 0;
 			return pthread_cond_timedwait (&cond,&mutex,&tspec) 
-				!= -1;}],
-			[AC_MSG_RESULT(no)],
-			[AC_MSG_RESULT(yes)
-			AC_DEFINE(HAVE_PTHREAD_COND_TIMEDWAIT_POSIX)])
+				!= -1;}]])],
+			[glib_ok=no],
+			[glib_ok=yes],
+			[glib_ok="guessing yes"])
+		AC_MSG_RESULT($glib_ok)
+		if test "$glib_ok" != no; then
+			AC_DEFINE(HAVE_PTHREAD_COND_TIMEDWAIT_POSIX)
+		fi
 	fi
 	LIBS="$glib_save_LIBS"
 	CFLAGS="$glib_save_CFLAGS"
@@ -927,7 +939,7 @@
 	GLIB_SIZEOF([#include <$mutex_header_file>],
                     $mutex_default_type,
                     gmutex,
-                    )
+                    1)
 	GLIB_BYTE_CONTENTS([#include <$mutex_header_file>],
 			   $mutex_default_type,
 			   gmutex,
@@ -952,7 +964,7 @@
 dnl *** output the whole stuff ***
 dnl ******************************
 
-AC_OUTPUT_COMMANDS([
+AC_CONFIG_COMMANDS([default-1],[[
 
 ## Generate `glibconfig.h' in two cases
 ## 1. `config.status' is run either explicitly, or via configure.
@@ -1166,7 +1178,7 @@
 	  mv $outfile glibconfig.h
 	fi ;;
 esac
-],[
+]],[[
 
 # Note that if two cases are the same, case goes with the first one.
 # Note also that this is inside an AC_OUTPUT_COMMAND.  We do not depend
@@ -1347,9 +1359,9 @@
 g_mutex_has_default="$mutex_has_default"
 g_mutex_sizeof="$glib_cv_sizeof_gmutex"
 g_mutex_contents="$glib_cv_byte_contents_gmutex"
-])
+]])
 
-AC_OUTPUT([
+AC_CONFIG_FILES([
 glib.spec
 Makefile
 glib-config
@@ -1365,3 +1377,5 @@
 ],[case "$CONFIG_FILES" in
 *glib-config*)chmod +x glib-config;;
 esac])
+
+AC_OUTPUT
diff -rup glib-1.2.10.orig/glib.m4 glib-1.2.10/glib.m4
--- glib-1.2.10.orig/glib.m4	1998-12-31 21:58:03.000000000 +0100
+++ glib-1.2.10/glib.m4	2023-03-27 14:23:09.556743038 +0200
@@ -5,7 +5,7 @@ dnl AM_PATH_GLIB([MINIMUM-VERSION, [ACTI
 dnl Test for GLIB, and define GLIB_CFLAGS and GLIB_LIBS, if "gmodule" or 
 dnl gthread is specified in MODULES, pass to glib-config
 dnl
-AC_DEFUN(AM_PATH_GLIB,
+AC_DEFUN([AM_PATH_GLIB],
 [dnl 
 dnl Get the cflags and libraries from the glib-config script
 dnl
@@ -18,43 +18,33 @@ AC_ARG_ENABLE(glibtest, [  --disable-gli
 
   if test x$glib_config_exec_prefix != x ; then
      glib_config_args="$glib_config_args --exec-prefix=$glib_config_exec_prefix"
-     if test x${GLIB_CONFIG+set} != xset ; then
-        GLIB_CONFIG=$glib_config_exec_prefix/bin/glib-config
-     fi
   fi
   if test x$glib_config_prefix != x ; then
      glib_config_args="$glib_config_args --prefix=$glib_config_prefix"
-     if test x${GLIB_CONFIG+set} != xset ; then
-        GLIB_CONFIG=$glib_config_prefix/bin/glib-config
-     fi
   fi
 
-  for module in . $4
+  for module in glib $4
   do
       case "$module" in
-         gmodule) 
-             glib_config_args="$glib_config_args gmodule"
-         ;;
-         gthread) 
-             glib_config_args="$glib_config_args gthread"
+         glib|gmodule|gthread) 
+             glib_config_args="$glib_config_args $module"
          ;;
       esac
   done
 
-  AC_PATH_PROG(GLIB_CONFIG, glib-config, no)
   min_glib_version=ifelse([$1], ,0.99.7,$1)
   AC_MSG_CHECKING(for GLIB - version >= $min_glib_version)
   no_glib=""
-  if test "$GLIB_CONFIG" = "no" ; then
+  if test "" = "no" ; then
     no_glib=yes
   else
-    GLIB_CFLAGS=`$GLIB_CONFIG $glib_config_args --cflags`
-    GLIB_LIBS=`$GLIB_CONFIG $glib_config_args --libs`
-    glib_config_major_version=`$GLIB_CONFIG $glib_config_args --version | \
+    GLIB_CFLAGS=`pkg-config --cflags $glib_config_args`
+    GLIB_LIBS=`pkg-config --libs $glib_config_args`
+    glib_config_major_version=`pkg-config --modversion glib | \
            sed 's/\([[0-9]]*\).\([[0-9]]*\).\([[0-9]]*\)/\1/'`
-    glib_config_minor_version=`$GLIB_CONFIG $glib_config_args --version | \
+    glib_config_minor_version=`pkg-config --modversion glib | \
            sed 's/\([[0-9]]*\).\([[0-9]]*\).\([[0-9]]*\)/\2/'`
-    glib_config_micro_version=`$GLIB_CONFIG $glib_config_args --version | \
+    glib_config_micro_version=`pkg-config --modversion glib | \
            sed 's/\([[0-9]]*\).\([[0-9]]*\).\([[0-9]]*\)/\3/'`
     if test "x$enable_glibtest" = "xyes" ; then
       ac_save_CFLAGS="$CFLAGS"
@@ -66,7 +56,7 @@ dnl Now check if the installed GLIB is s
 dnl checks the results of glib-config to some extent
 dnl
       rm -f conf.glibtest
-      AC_TRY_RUN([
+      AC_RUN_IFELSE([AC_LANG_SOURCE([[
 #include <glib.h>
 #include <stdio.h>
 #include <stdlib.h>
@@ -138,7 +128,7 @@ main ()
     }
   return 1;
 }
-],, no_glib=yes,[echo $ac_n "cross compiling; assumed OK... $ac_c"])
+]])],, no_glib=yes,[echo $ac_n "cross compiling; assumed OK... $ac_c"])
        CFLAGS="$ac_save_CFLAGS"
        LIBS="$ac_save_LIBS"
      fi
@@ -160,10 +150,10 @@ main ()
           echo "*** Could not run GLIB test program, checking why..."
           CFLAGS="$CFLAGS $GLIB_CFLAGS"
           LIBS="$LIBS $GLIB_LIBS"
-          AC_TRY_LINK([
+          AC_LINK_IFELSE([AC_LANG_PROGRAM([[
 #include <glib.h>
 #include <stdio.h>
-],      [ return ((glib_major_version) || (glib_minor_version) || (glib_micro_version)); ],
+]],     [[ return ((glib_major_version) || (glib_minor_version) || (glib_micro_version)); ]])],
         [ echo "*** The test program compiled, but did not run. This usually means"
           echo "*** that the run-time linker is not finding GLIB or finding the wrong"
           echo "*** version of GLIB. If it is not finding GLIB, you'll need to set your"
diff -rup glib-1.2.10.orig/gmodule/Makefile.am glib-1.2.10/gmodule/Makefile.am
--- glib-1.2.10.orig/gmodule/Makefile.am	2001-03-15 16:33:10.000000000 +0100
+++ glib-1.2.10/gmodule/Makefile.am	2023-03-27 14:24:41.908636275 +0200
@@ -1,6 +1,6 @@
 ## Process this file with automake to produce Makefile.in
 
-INCLUDES = -I$(top_srcdir) -I$(top_srcdir)/gmodule \
+AM_CPPFLAGS = -I$(top_srcdir) -I$(top_srcdir)/gmodule \
 	-DG_LOG_DOMAIN=\"GModule\" @GLIB_DEBUG_FLAGS@
 
 EXTRA_DIST =	\
@@ -42,7 +42,7 @@ libgplugin_b_la_LDFLAGS = @G_MODULE_LDFL
 libgplugin_b_la_LIBADD = @G_MODULE_LIBS@ # $(libglib)
 
 noinst_PROGRAMS = testgmodule
-testgmodule_LDFLAGS += @G_MODULE_LDFLAGS@
+testgmodule_LDFLAGS = @G_MODULE_LDFLAGS@
 testgmodule_LDADD = libgmodule.la $(libglib) @G_MODULE_LIBS@
 
 .PHONY: files release
diff -rup glib-1.2.10.orig/gthread/Makefile.am glib-1.2.10/gthread/Makefile.am
--- glib-1.2.10.orig/gthread/Makefile.am	1999-08-26 15:09:43.000000000 +0200
+++ glib-1.2.10/gthread/Makefile.am	2023-03-27 14:23:09.556743038 +0200
@@ -1,6 +1,6 @@
 ## Process this file with automake to produce Makefile.in
 
-INCLUDES = -I$(top_srcdir) -I$(top_srcdir)/gthread -DG_LOG_DOMAIN=\"GThread\"
+AM_CPPFLAGS = -I$(top_srcdir) -I$(top_srcdir)/gthread -DG_LOG_DOMAIN=\"GThread\"
 
 EXTRA_DIST =				\
 		gthread-posix.c		\
diff -rup glib-1.2.10.orig/tests/Makefile.am glib-1.2.10/tests/Makefile.am
--- glib-1.2.10.orig/tests/Makefile.am	1999-07-30 01:38:17.000000000 +0200
+++ glib-1.2.10/tests/Makefile.am	2023-03-27 14:23:09.556743038 +0200
@@ -1,5 +1,5 @@
 
-INCLUDES = -I$(top_srcdir)
+AM_CPPFLAGS = -I$(top_srcdir)
 
 EXTRA_DIST = \
 	makefile.msc \
--- glib-1.2.10.orig/glib.pc.in	2000-11-30 02:15:33.000000000 +0100
+++ glib-1.2.10/glib.pc.in	2023-03-27 14:59:00.218283084 +0200
@@ -6,6 +6,6 @@
 Name: GLib
 Description: C Utility Library
 Version: @VERSION@
-Libs: -L${libdir} -lglib
-Cflags: -I${includedir}/glib-1.2 -I${libdir}/glib/include 
+Libs: -lglib
+Cflags: -I${includedir}/glib-1.2
 
--- glib-1.2.10.orig/gmodule.pc.in	2000-11-30 02:15:33.000000000 +0100
+++ glib-1.2.10/gmodule.pc.in	2023-03-27 14:59:00.218283084 +0200
@@ -7,5 +7,5 @@
 Description: Dynamic module loader for GLib
 Requires: glib
 Version: @VERSION@
-Libs: -L${libdir} @G_MODULE_LDFLAGS@ -lgmodule @G_MODULE_LIBS@
+Libs: @G_MODULE_LDFLAGS@ -lgmodule @G_MODULE_LIBS@
 Cflags:
--- glib-1.2.10.orig/gthread.pc.in	2000-11-30 02:15:33.000000000 +0100
+++ glib-1.2.10/gthread.pc.in	2023-03-27 14:58:59.306284138 +0200
@@ -7,5 +7,5 @@
 Description: Thread support for GLib
 Requires: glib
 Version: @VERSION@
-Libs: -L${libdir} -lgthread @G_THREAD_LIBS@
+Libs: -lgthread @G_THREAD_LIBS@
 Cflags: @G_THREAD_CFLAGS@
